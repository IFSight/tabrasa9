name: if-tabrasa-9
recipe: drupal9

config:
  webroot: web
  xdebug: true
  config:
    php: .vscode/php.ini

tooling:
  drush:
    service: appserver
    env:
      DRUSH_OPTIONS_URI: "https://tabrasa9.lndo.site"
  npm:
    service: appserver
  gulp:
    service: appserver
  xdebug-on:
    service: appserver
    description: Enable xdebug for Apache.
    cmd: docker-php-ext-enable xdebug && /etc/init.d/apache2 reload && echo "Enabling xdebug"
    user: root
  xdebug-off:
    service: appserver
    description: Disable xdebug for Apache.
    cmd: rm /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && /etc/init.d/apache2 reload && echo "Disabling xdebug"
    user: root
  appserver:
    - my-subsite.site.lndo.site

proxy:
  appserver:
    - tabrasa9.lndo.site
    - my.lndo.site
    - subsite.my.lndo.site


services:
  appserver:
    build:
      - composer install
  subsite_db:
    type: mysql
    portforward: true
    creds:
      user: drupal
      password: drupal
      database: drupal_subsite

events:
  post-start:
    - lando disable-xdebug

excludes:
  - vendor
  - web/modules/contrib
  - web/themes/contrib
  # - web/themes/custom/*/node_modules
